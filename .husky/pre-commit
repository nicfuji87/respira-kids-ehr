#!/usr/bin/env sh
# AI dev note: Pre-commit hook para garantir qualidade e seguranÃ§a

echo "ğŸ” Executando verificaÃ§Ãµes pre-commit..."

# 1. Verificar se existem credenciais expostas
echo "ğŸ” Verificando credenciais expostas..."
if grep -r "VITE_.*SECRET" src/ 2>/dev/null; then
  echo "âŒ ERRO: Credenciais secretas encontradas no cÃ³digo frontend!"
  echo "Remova qualquer VITE_*_SECRET do cÃ³digo antes de fazer commit."
  exit 1
fi

# 2. Type check
echo "ğŸ”§ Verificando tipos TypeScript..."
npm run type-check
if [ $? -ne 0 ]; then
  echo "âŒ ERRO: Falhas na verificaÃ§Ã£o de tipos!"
  exit 1
fi

# 3. Lint
echo "ğŸ“ Verificando lint..."
npm run lint
if [ $? -ne 0 ]; then
  echo "âŒ ERRO: Falhas no lint!"
  echo "Execute 'npm run lint -- --fix' para corrigir automaticamente."
  exit 1
fi

# 4. Verificar se o build funciona
echo "ğŸ”¨ Testando build..."
npm run build
if [ $? -ne 0 ]; then
  echo "âŒ ERRO: Falha no build!"
  exit 1
fi

echo "âœ… Todas as verificaÃ§Ãµes passaram! Commit liberado." 